<div
  class="task-card"
  [class.completed]="task()?.isCompleted"
  (click)="taskClick.emit()"
>
  <div class="task-header">
    <div class="checkbox-wrapper">
      <input
        type="checkbox"
        class="task-checkbox"
        [checked]="task()?.isCompleted"
        (click)="onToggleComplete($event)"
        title="Mark as complete"
      />
      <h1 class="task-title">{{ task()?.title }}</h1>
    </div>
    <button class="btn-delete" (click)="onDelete($event)" title="Delete Task">
      Delete
    </button>
  </div>

  @if (task()?.description) {
  <p class="task-description">{{ task()?.description }}</p>
  }

  <div class="task-footer">
    @let tags = task()?.tags; @if (tags && tags.length > 0) {
    <div class="tags">
      @for (tag of tags.slice(0, 3); track tag.id) {
      <span class="tag" [style.background-color]="tag.color">
        {{ tag.name }}
      </span>
      } @if (tags.length > 3) {
      <span class="tag-more">+{{ tags.length - 3 }}</span>
      }
    </div>
    }
  </div>

  <div class="task-meta">
    @if(task()?.dueDate) {
    <span
      class="meta-item due-date"
      [class.overdue]="isOverdue(task()?.dueDate!)"
      >Due: {{ formatDueDate(task()?.dueDate!) }}</span
    >
    }

    <div class="comments-section">
      <h3>Comments</h3>
      @let comments = task()?.comments; @if (comments) {
      <p class="comment-count">{{ comments.length }} comments</p>
      }
    </div>
  </div>
</div>
