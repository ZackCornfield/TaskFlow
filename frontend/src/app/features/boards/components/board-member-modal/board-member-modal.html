<div class="modal-overlay" (click)="close()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Board Members</h3>
      <button class="btn-close" (click)="close()">✕</button>
    </div>
    <div class="modal-body">
      <div class="add-member-section">
        <h4>Invite Members</h4>
        <div class="add-member-form">
          <input
            type="email"
            [(ngModel)]="newMemberEmail"
            placeholder="Enter email address"
            class="email-input"
          />
          <select [(ngModel)]="newMemberRole" class="role-select">
            <option value="member">Member</option>
            <option value="admin">Admin</option>
          </select>
          <button
            class="btn-add"
            (click)="addMember()"
            [disabled]="!newMemberEmail.trim()"
          >
            Add Member
          </button>
          {{ isAdding ? "Adding..." : "" }}
        </div>
      </div>

      <div class="members-section">
        <h4>Current Members ({{ members().length }})</h4>

        @if (isLoading) {
        <div class="loading-members">Loading members...</div>
        } @if(!isLoading && members().length === 0) {
        <div class="empty-state">No members in this board.</div>
        }

        <div class="members-list">
          @for(member of members(); track member.userId) {
          <div class="member-item">
            <div class="member-avatar">
              {{ getInitials(member.user.displayName) }}
            </div>

            <div class="member-info">
              <div class="member-name">{{ member.user.displayName }}</div>
              <div class="member-email">{{ member.user.email }}</div>
            </div>

            <div class="member-role">
              <span class="role-badge" [class.admin]="member.role === 'admin'">
                {{ member.role }}
              </span>
            </div>
            @if (canRemoveMember(member)) {
            <button
              class="btn-remove"
              (click)="removeMember(member)"
              title="Remove member"
            >
              ✕
            </button>
            }
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
